var AssetTypeJs=new Class.create();AssetTypeJs.prototype={canvas:"",callbackIds:{list:"",edit:""},initialize:function(b,a,c){this.canvasId=b;this.callbackIds.list=a;this.callbackIds.edit=c},getList:function(a){var b={};b.canvasId=this.canvasId;b.loading=(a===true?false:true);appJs.postAjax(this.callbackIds.list,{},{onLoading:function(c,d){if(b.loading===true){$(b.canvasId).update('<img src="/contents/images/loading.gif" />')}},onComplete:function(c,d){b.result=appJs.getResp(d);b.count=b.result.size();if(b.count===0){$(b.canvasId).update("No AssetType Found!");return}$(b.canvasId).update("");for(b.i=0;b.i<b.count;b.i++){b.newRow=assetJs.getRow(b.result[b.i],b.i);$(b.canvasId).insert({bottom:b.newRow})}}})},getRow:function(c,b){var a={};a.newRow=new Element("div",{"class":"row "+(b%2===0?"even":"odd"),assetId:c.id,rowno:b});a.newRowContent=new Element("span",{"class":"conent"});a.newRowContent.insert({bottom:new Element("span",{"class":"fromacc inline"}).update("Name: "+c.type)});a.newRowContent.insert({bottom:new Element("span",{"class":"toacc inline"}).update("Path: "+c.path)});a.newRow.insert({bottom:a.newRowContent});a.newRowBtns=new Element("span",{"class":"btns"});a.newRowBtns.insert({bottom:new Element("a",{"class":"btn",href:"javascript: void(0);"}).update("Edit").observe("click",function(){assetJs.edit(this,c)})});a.newRow.insert({bottom:a.newRowBtns});return a.newRow},edit:function(b,c){var a={};$$(".newAccDiv").each(function(d){d.remove()});a.newDivId="edit_"+c.id;a.newDiv=new Element("div",{id:a.newDivId,"class":"newAccDiv"});a.newRow=new Element("div",{"class":"newRow"}).insert({bottom:new Element("span",{"class":"label"}).update("Name: ")}).insert({bottom:new Element("span",{"class":"typein"}).update(new Element("input",{editinfo:"name",type:"text","class":"transcomments inputbox",placeholder:"Asset Type Name",value:c.type}))});a.newDiv.insert({bottom:a.newRow});a.newRow1=new Element("div",{"class":"newRow"}).insert({bottom:new Element("span",{"class":"label"}).update("Path: ")}).insert({bottom:new Element("span",{"class":"typein"}).update(new Element("input",{editinfo:"path",type:"text","class":"transcomments inputbox",placeholder:"Asset Type Path",value:c.path}))});a.newDiv.insert({bottom:a.newRow1});a.newRow5=new Element("div",{"class":"newRow"}).insert({bottom:new Element("input",{"class":"submitBtn",type:"button",value:"Save"}).observe("click",function(){assetJs.save(this,c.id)})}).insert({bottom:new Element("input",{"class":"submitBtn",type:"button",value:"Cancel",style:"float:right;"}).observe("click",function(){$(a.newDivId).remove()})});a.newDiv.insert({bottom:a.newRow5});$(b).up(".row").insert({bottom:a.newDiv})},save:function(c,a){var b={};b.row=$(c).up(".newRow");b.savingPanel=b.row.up(".newAccDiv");b.savingInfo=new Element("div").update("saving ...");b.editInfo={id:a};b.hasError=false;b.savingPanel.getElementsBySelector(".newAccError").each(function(d){d.remove()});b.currency=/^\d*(\.|)\d{0,2}$/g;b.savingPanel.getElementsBySelector("[editinfo]").each(function(d){b.field=d.readAttribute("editinfo");b.value=$F(d);if(b.field==="name"&&b.value.blank()){d.insert({after:new Element("span",{"class":"newAccError"}).update("Name is needed!")});b.hasError=true}if(b.field==="path"&&b.value.blank()){d.insert({after:new Element("span",{"class":"newAccError"}).update("Path is needed!")});b.hasError=true}b.editInfo[b.field]=b.value});if(b.hasError===true){return}appJs.postAjax(this.callbackIds.edit,b.editInfo,{onLoading:function(d,e){b.row.hide().insert({after:b.savingInfo})},onComplete:function(d,g){try{b.result=appJs.getResp(g,false,true);if(b.result.id===undefined||b.result.id.blank()){throw"System Error:Invalid id!"}b.transRow=$(c).up(".row");b.transRow.replace(assetJs.getRow(b.result,b.transRow.readAttribute("rowno"))).scrollTo();b.savingPanel.remove()}catch(f){b.savingInfo.remove();b.row.show();alert(f)}}})}};