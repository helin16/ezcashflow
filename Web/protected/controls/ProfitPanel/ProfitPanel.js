var ProfitPanel=new Class.create();ProfitPanel.prototype={accIds:{income:[],expense:[]},resultDivId:"",callbackIds:{getInfo:""},initialize:function(b,a){this.resultDivId=b;this.callbackIds.getInfo=a},loadInfo:function(b,a){var c={};c.holderDiv=this.resultDivId;c.excludeIncomePos=(b===undefined?"":b);c.excludeExpensePos=(a===undefined?"":a);appJs.postAjax(this.callbackIds.getInfo,{excludeIncomePos:c.excludeIncomePos,excludeExpensePos:c.excludeExpensePos},{onLoading:function(d,e){$(c.holderDiv).update('<img src="/contents/images/loading.gif" style="display:block; with:150px; height:150px;"/>')},onComplete:function(d,e){c.result=appJs.getResp(e);$(c.holderDiv).update(profitJs.formatInfo(c.result))}});return false},getHeaderRow:function(b){var a={};a.headerRow=new Element("div",{"class":"headerRow"});a.headerRow_headr=new Element("span",{"class":"headerCell headerCol"});a.headerRow_headr.insert({bottom:new Element("span",{"class":"headerTitle"}).update("&nbsp;")});a.headerRow_headr.insert({bottom:new Element("span",{"class":"headerRange"}).update("&nbsp;")});a.headerRow.insert({bottom:a.headerRow_headr});a.headerRow_day=new Element("span",{"class":"headerCell dayCol"});a.headerRow_day.insert({bottom:new Element("span",{"class":"headerTitle"}).update("Day")});a.headerRow_day.insert({bottom:new Element("span",{"class":"headerRange"}).update(b.day.range.start+" ~ "+b.day.range.end)});a.headerRow.insert({bottom:a.headerRow_day});a.headerRow_week=new Element("span",{"class":"headerCell weekCol"});a.headerRow_week.insert({bottom:new Element("span",{"class":"headerTitle"}).update("Week")});a.headerRow_week.insert({bottom:new Element("span",{"class":"headerRange"}).update(b.week.range.start+" ~ "+b.week.range.end)});a.headerRow.insert({bottom:a.headerRow_week});a.headerRow_month=new Element("span",{"class":"headerCell monthCol"});a.headerRow_month.insert({bottom:new Element("span",{"class":"headerTitle"}).update("Month")});a.headerRow_month.insert({bottom:new Element("span",{"class":"headerRange"}).update(b.month.range.start+" ~ "+b.month.range.end)});a.headerRow.insert({bottom:a.headerRow_month});a.headerRow_year=new Element("span",{"class":"headerCell yearCol"});a.headerRow_year.insert({bottom:new Element("span",{"class":"headerTitle"}).update("Year")});a.headerRow_year.insert({bottom:new Element("span",{"class":"headerRange"}).update(b.year.range.start+" ~ "+b.year.range.end)});a.headerRow.insert({bottom:a.headerRow_year});a.headerRow_all=new Element("span",{"class":"headerCell allCol"});a.headerRow_all.insert({bottom:new Element("span",{"class":"headerTitle"}).update("All")});a.headerRow_all.insert({bottom:new Element("span",{"class":"headerRange"}).update(b.all.range.start+" ~ "+b.all.range.end)});a.headerRow.insert({bottom:a.headerRow_all});return a.headerRow},getIncomeRow:function(i,h,a,f,g,j,k,c,b,l,e){var d={};d.row=new Element("div",{"class":i+"Row"});d.isIncome=(i.toLowerCase()==="income");d.headerRow_headr=new Element("div",{"class":"headerCell headerCol"}).update(i);d.row.insert({bottom:d.headerRow_headr});d.headerRow_day=this.formatCell(i,"day",h,(k!==undefined?this.makeUrl(k.start,k.end,d.isIncome):undefined));d.row.insert({bottom:d.headerRow_day});d.headerRow_week=this.formatCell(i,"week",a,(c!==undefined?this.makeUrl(c.start,c.end,d.isIncome):undefined));d.row.insert({bottom:d.headerRow_week});d.headerRow_month=this.formatCell(i,"month",f,(b!==undefined?this.makeUrl(b.start,b.end,d.isIncome):undefined));d.row.insert({bottom:d.headerRow_month});d.headerRow_year=this.formatCell(i,"year",g,(l!==undefined?this.makeUrl(l.start,l.end,d.isIncome):undefined));d.row.insert({bottom:d.headerRow_year});d.headerRow_all=this.formatCell(i,"all",j,(e!==undefined?this.makeUrl(e.start,e.end,d.isIncome):undefined));d.row.insert({bottom:d.headerRow_all});return d.row},formatCell:function(e,c,d,a){var b={};b.cellData="$"+appJs.getCurrency(d);if(a!==undefined){b.cellData=new Element("a",{href:a}).update("$"+appJs.getCurrency(d))}b.cell=new Element("span",{"class":c+"Col dataCol"+(d<0?" minusCurrency":""),value:d}).update(b.cellData);b.cell.writeAttribute(e.toLowerCase(),c);return b.cell},formatInfo:function(b){var a={};this.accIds.income=b.accIds[3];this.accIds.expense=b.accIds[4];a.div=new Element("div",{"class":"profitPanel"});a.div.insert({bottom:this.getHeaderRow(b)});a.div.insert({bottom:this.getIncomeRow("Income",b.day.income,b.week.income,b.month.income,b.year.income,b.all.income,b.day.range,b.week.range,b.month.range,b.year.range,b.all.range)});a.div.insert({bottom:this.getIncomeRow("Expense",b.day.expense,b.week.expense,b.month.expense,b.year.expense,b.all.expense,b.day.range,b.week.range,b.month.range,b.year.range,b.all.range)});a.diff=this.genDiff(a.div);a.div.insert({bottom:this.getIncomeRow("Diff",a.diff.day,a.diff.week,a.diff.month,a.diff.year,a.diff.all)});return a.div},genDiff:function(b){var a={};a.income={};$(b).getElementsBySelector(".dataCol[income]").each(function(c){a.colName=c.readAttribute("income");a.income[a.colName]=c.readAttribute("value")});a.diff={};$(b).getElementsBySelector(".dataCol[expense]").each(function(c){a.colName=c.readAttribute("expense");a.diff[a.colName]=(a.income[a.colName]-c.readAttribute("value"))});return a.diff},makeUrl:function(d,a,c){var b={};b.toAccIds=(c===true?this.accIds.income:this.accIds.expense);b.array={fromAccountIds:[],toAccountIds:b.toAccIds,fromDate:d,toDate:a};return"/reports/"+Object.toJSON(b.array)}};